{% load cms_tags sekizai_tags static %}
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet">
<nav class="navbar navbar-expand-lg rounded" aria-label="Main navigation">
    <div class="container-fluid">
        <!-- Toggler for Mobile -->
        <button class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarContent"
                aria-controls="navbarContent"
                aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse d-lg-flex" id="navbarContent">
            <!-- LEFT: Brand -->
            <a class="navbar-brand col-lg-auto me-0 d-flex align-items-center"
               href="{% url 'index' %}">
                <img src="{% static 'images/aimlogotransparentnotext.png' %}"
                     alt="American Institute of Mathematics"
                     class=""
                     style="max-height: 90px">
            </a>
            <!-- CENTER: Navigation -->
            <ul class="navbar-nav col-lg-10 justify-content-lg-center gap-3">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'index' %}">Home</a>
                </li>
                <!-- Focused Collaborative Research -->
                <li class="nav-item dropdown">
                    {% page_url 'collaborative' as collaborative_url %}
                    {% if collaborative_url %}
                        <a class="nav-link dropdown-toggle"
                           href="{{ collaborative_url }}"
                           role="button"
                           aria-expanded="false">Focused Collaborative Research</a>
                        <ul class="dropdown-menu" aria-labelledby="collaborativeDropdown">
                            <div class="d-flex flex-wrap">
                                <div class="flex-fill">
                                    <h6 class="dropdown-header">Workshops</h6>
                                    <a class="dropdown-item" href="{{ collaborative_url }}#workshops">Workshops</a>
                                    <a class="dropdown-item" href="{{ collaborative_url }}#squares">SQuaREs</a>
                                </div>
                                <div class="flex-fill">
                                    <h6 class="dropdown-header">Projects</h6>
                                    <a class="dropdown-item"
                                       href="{{ collaborative_url }}#research-communities">Research Communities</a>
                                    <a class="dropdown-item" href="{{ collaborative_url }}#reuf">REUF</a>
                                    <a class="dropdown-item" href="{{ collaborative_url }}#roots-of-unity">Roots of Unity</a>
                                </div>
                                <div class="flex-fill">
                                    <h6 class="dropdown-header">Other</h6>
                                    <a class="dropdown-item"
                                       href="{{ collaborative_url }}#alexanderson-award">Alexanderson Award</a>
                                    <a class="dropdown-item" href="{% page_url 'frg' %}">FRG</a>
                                </div>
                            </div>
                        </ul>
                    </li>
                {% endif %}
                <!-- Joyful Mathematics -->
                <li class="nav-item dropdown">
                    {% page_url 'joyful' as joyful_url %}
                    {% if joyful_url %}
                        <a class="nav-link dropdown-toggle"
                           href="{{ joyful_url }}"
                           aria-expanded="false">Joyful Mathematics For All</a>
                        <ul class="dropdown-menu">
                            <div class="d-flex flex-wrap">
                                <div class="flex-fill">
                                    <h6 class="dropdown-header">Partnerships</h6>
                                    <a class="dropdown-item" href="{{ joyful_url }}#math-circles">Math Circle Network</a>
                                    <a class="dropdown-item" href="{{ joyful_url }}#math-communities">Math Communities</a>
                                </div>
                                <div class="flex-fill">
                                    <h6 class="dropdown-header">Other</h6>
                                    <a class="dropdown-item" href="{{ joyful_url }}#match">MATCH</a>
                                    <a class="dropdown-item" href="{{ joyful_url }}#math-border">Math on the Border</a>
                                    <a class="dropdown-item" href="{{ joyful_url }}#morgan-hill">Morgan Hill Math</a>
                                </div>
                            </div>
                        </ul>
                    </li>
                {% endif %}
                <!-- Visiting -->
                {% page_url 'visiting' as visiting_url %}
                {% if visiting_url %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle"
                           href="{{ visiting_url }}"
                           aria-expanded="false">Visiting</a>
                        <ul class="dropdown-menu">
                            <a class="dropdown-item" href="{{ visiting_url }}#code-of-conduct">Code of Conduct</a>
                            <a class="dropdown-item" href="{{ visiting_url }}#local-information">Local Information</a>
                            <a class="dropdown-item" href="{{ visiting_url }}#travel-guidelines">Travel Guidelines</a>
                            <a class="dropdown-item" href="{{ visiting_url }}#child-care">Child Care</a>
                            <a class="dropdown-item" href="{{ visiting_url }}#explore-pasadena">Explore Pasadena</a>
                            <a class="dropdown-item" href="{{ visiting_url }}#facilities">Facilities</a>
                            <a class="dropdown-item" href="{{ visiting_url }}#accessibility">Accessibility</a>
                            <a class="dropdown-item" href="{{ visiting_url }}#faq">FAQ</a>
                        </ul>
                    </li>
                {% endif %}
                <!-- Resources -->
                {% page_url 'resources' as resources_url %}
                {% if resources_url %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle"
                           href="{{ resources_url }}"
                           aria-expanded="false">Resources</a>
                        <ul class="dropdown-menu">
                            <div class="d-flex flex-wrap">
                                <div class="flex-fill">
                                    <h6 class="dropdown-header">Resources</h6>
                                    <a class="dropdown-item" href="{{ resources_url }}#careers-advice">Math Careers Advice</a>
                                    <a class="dropdown-item"
                                       href="{{ resources_url }}#open-textbook-initiative">Open Textbook Initiative</a>
                                    <a class="dropdown-item" href="{{ resources_url }}#videos">Videos</a>
                                    <a class="dropdown-item" href="{{ resources_url }}#problem-list">Problem Lists</a>
                                    <a class="dropdown-item" href="{{ resources_url }}#preprint-series">Preprint Series</a>
                                    <a class="dropdown-item" href="{{ resources_url }}#published-paper">Published Papers</a>
                                </div>
                                <div class="flex-fill">
                                    <h6 class="dropdown-header">Library</h6>
                                    <a class="dropdown-item" href="#">Reprints</a>
                                </div>
                            </div>
                        </ul>
                    </li>
                {% endif %}
                <!-- About -->
                {% page_url 'about' as about_url %}
                {% if about_url %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle"
                           href="{{ about_url }}"
                           aria-expanded="false">About</a>
                        <ul class="dropdown-menu">
                            <a class="dropdown-item" href="{{ about_url }}#contact">Contact</a>
                            <a class="dropdown-item" href="{{ about_url }}#staff">Staff</a>
                            <a class="dropdown-item" href="{{ about_url }}#governance">Governance</a>
                            {# <a class="dropdown-item" href="{{ about_url }}#diversity">Diversity</a> #}
                            <a class="dropdown-item" href="{{ about_url }}#mission-history">Mission & History</a>
                        </ul>
                    </li>
                {% endif %}
                <!-- News -->
                {% page_url 'news' as news_url %}
                {% if news_url %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle"
                           href="{{ news_url }}"
                           aria-expanded="false">News</a>
                        <ul class="dropdown-menu">
                            <a class="dropdown-item" href="{{ news_url }}#news-letter">Newsletter</a>
                            <a class="dropdown-item" href="{{ news_url }}#news-stories">News Stories</a>
                        </ul>
                    </li>
                {% endif %}
                <!-- Support AIM -->
                <li class="nav-item">
                    <a class="nav-link" href="">Support AIM</a>
                </li>
                <li class="nav-item dropdown">
                    <button class="btn btn-link nav-link py-2 px-0 px-lg-2 dropdown-toggle"
                            id="bd-theme"
                            type="button"
                            aria-expanded="false"
                            data-bs-toggle="dropdown"
                            data-bs-display="static"
                            style="background: none;
                                   border: none;
                                   color: inherit">
                        <!-- Active theme icon -->
                        <svg xmlns="http://www.w3.org/2000/svg"
                             width="16"
                             height="16"
                             fill="currentColor"
                             class="bi theme-icon-active"
                             viewBox="0 0 16 16">
                            <!-- Default icon (Light) -->
                            <path d="M8 3a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 3m8 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5m-13.5.5a.5.5 0 0 0 0-1h-2a.5.5 0 0 0 0 1zm11.157-6.157a.5.5 0 0 1 0 .707l-1.414 1.414a.5.5 0 1 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m-9.9 2.121a.5.5 0 0 0 .707-.707L3.05 5.343a.5.5 0 1 0-.707.707zM8 7a4 4 0 0 0-4 4 .5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5 4 4 0 0 0-4-4" />
                        </svg>
                        <span id="bd-theme-text" class="visually-hidden">Theme</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <!-- Light -->
                        <li>
                            <button type="button"
                                    class="dropdown-item d-flex align-items-center"
                                    data-bs-theme-value="light">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="16"
                                     height="16"
                                     fill="currentColor"
                                     class="bi bi-brightness-alt-high-fill"
                                     viewBox="0 0 16 16">
                                    <path d="M8 3a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 3m8 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5m-13.5.5a.5.5 0 0 0 0-1h-2a.5.5 0 0 0 0 1zm11.157-6.157a.5.5 0 0 1 0 .707l-1.414 1.414a.5.5 0 1 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m-9.9 2.121a.5.5 0 0 0 .707-.707L3.05 5.343a.5.5 0 1 0-.707.707zM8 7a4 4 0 0 0-4 4 .5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5 4 4 0 0 0-4-4" />
                                </svg>
                                Light
                                <svg class="bi ms-auto d-none">
                                    <use href="#check2"></use>
                                </svg>
                            </button>
                        </li>
                        <!-- Dark -->
                        <li>
                            <button type="button"
                                    class="dropdown-item d-flex align-items-center"
                                    data-bs-theme-value="dark">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="16"
                                     height="16"
                                     fill="currentColor"
                                     class="bi bi-moon-fill"
                                     viewBox="0 0 16 16">
                                    <path d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278" />
                                </svg>
                                Dark
                                <svg class="bi ms-auto d-none">
                                    <use href="#check2"></use>
                                </svg>
                            </button>
                        </li>
                        <!-- Auto -->
                        <li>
                            <button type="button"
                                    class="dropdown-item d-flex align-items-center active"
                                    data-bs-theme-value="auto"
                                    aria-pressed="true">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="16"
                                     height="16"
                                     fill="currentColor"
                                     class="bi bi-gear-wide"
                                     viewBox="0 0 16 16">
                                    <path d="M8.932.727c-.243-.97-1.62-.97-1.864 0l-.071.286a.96.96 0 0 1-1.622.434l-.205-.211c-.695-.719-1.888-.03-1.613.931l.08.284a.96.96 0 0 1-1.186 1.187l-.284-.081c-.96-.275-1.65.918-.931 1.613l.211.205a.96.96 0 0 1-.434 1.622l-.286.071c-.97.243-.97 1.62 0 1.864l.286.071a.96.96 0 0 1 .434 1.622l-.211.205c-.719.695-.03 1.888.931 1.613l.284-.08a.96.96 0 0 1 1.187 1.187l-.081.283c-.275.96.918 1.65 1.613.931l.205-.211a.96.96 0 0 1 1.622.434l.071.286c.243.97 1.62.97 1.864 0l.071-.286a.96.96 0 0 1 1.622-.434l.205.211c.695.719 1.888.03 1.613-.931l-.08-.284a.96.96 0 0 1 1.187-1.187l.283.081c.96.275 1.65-.918.931-1.613l-.211-.205a.96.96 0 0 1 .434-1.622l.286-.071c.97-.243.97-1.62 0-1.864l-.286-.071a.96.96 0 0 1-.434-1.622l.211-.205c.719-.695.03-1.888-.931-1.613l-.284.08a.96.96 0 0 1-1.187-1.186l.081-.284c.275-.96-.918-1.65-1.613-.931l-.205.211a.96.96 0 0 1-1.622-.434zM8 12.997a4.998 4.998 0 1 1 0-9.995 4.998 4.998 0 0 1 0 9.996z" />
                                </svg>
                                Auto
                                <svg class="bi ms-auto d-none">
                                    <use href="#check2"></use>
                                </svg>
                            </button>
                        </li>
                    </ul>
                </li>
                <!-- RIGHT: Theme Switcher -->
            </div>
        </div>
    </nav>
